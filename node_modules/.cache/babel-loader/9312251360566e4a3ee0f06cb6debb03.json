{"ast":null,"code":"import _regeneratorRuntime from\"/Users/laiyiying/Desktop/wp-final-project-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/laiyiying/Desktop/wp-final-project-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/laiyiying/Desktop/wp-final-project-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useState,useEffect}from\"react\";import\"./detail.css\";import Feature from'./feature';import Badge from'@material-ui/core/Badge';import{withStyles}from'@material-ui/core/styles';import IconButton from'@material-ui/core/IconButton';import Button from'@material-ui/core/Button';import Typography from'@material-ui/core/Typography';import{ThemeProvider}from'@material-ui/core/styles';import{createMuiTheme}from'@material-ui/core/styles';import Grid from\"@material-ui/core/Grid\";import Card from'@material-ui/core/Card';import CardHeader from\"@material-ui/core/CardHeader\";import{makeStyles}from'@material-ui/core/styles';import Ratings from\"./rating\";import{Avatar,CardMedia}from\"@material-ui/core\";import Box from'@material-ui/core/Box';import{useParams}from\"react-router\";import axios from'../../../api';import Item from'../../../components/Item';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Detail=function Detail(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),detailInfo=_useState2[0],setDetailInfo=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),recommand=_useState4[0],setRecommand=_useState4[1];var id=useParams();useEffect(function(){fetchDetailInfos();},[]);var fetchDetailInfos=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,_yield$axios$get$data,message,productInfo,productInfoObject;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(id);_context.prev=1;_context.next=4;return axios.get('/api/get-product-info',{params:id});case 4:_yield$axios$get=_context.sent;_yield$axios$get$data=_yield$axios$get.data;message=_yield$axios$get$data.message;productInfo=_yield$axios$get$data.productInfo;productInfoObject=JSON.parse(productInfo);console.log(message);setDetailInfo(productInfoObject);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);throw Error(\"When fetching detail information => Error: \".concat(_context.t0));case 16:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function fetchDetailInfos(){return _ref.apply(this,arguments);};}();var fetchRecommandInfos=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(address,productName,traderName){var recommandItems,district,productType,trader,re,traderAndBranch,recommandType,searchTypeIndex,i,searchType,_yield$axios$get2,productInfo,recommandItem;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:recommandItems=[];console.log(address);// XX區.....\ndistrict=address.slice(0,3);// XX麵包 / XX蛋糕 / 兩個字的\nproductType=productName.slice(-2);// 店家名稱 連鎖店名--分店店名\n// e.g. 全聯--大安店\nif(traderName.includes('--')){re=/\\s*--\\s*/;traderAndBranch=traderName.split(re);trader=traderAndBranch[0];}else trader=traderName;recommandType=[productType,trader,district];searchTypeIndex=['productName','traderName','address'];i=0;case 8:if(!(i<recommandType.length)){_context2.next=25;break;}searchType=searchTypeIndex[i];_context2.prev=10;_context2.next=13;return axios.get('/api/get-product-info',{params:{searchString:recommandType[i],searchType:searchType}});case 13:_yield$axios$get2=_context2.sent;productInfo=_yield$axios$get2.data.productInfo;recommandItem=JSON.parse(productInfo);recommandItems.push(recommandItem[0]);_context2.next=22;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](10);throw new Error('Error at get recommand items'+_context2.t0);case 22:i++;_context2.next=8;break;case 25:setRecommand(recommandItems);case 26:case\"end\":return _context2.stop();}}},_callee2,null,[[10,19]]);}));return function fetchRecommandInfos(_x,_x2,_x3){return _ref2.apply(this,arguments);};}();var productName=detailInfo.productName,onSalePrice=detailInfo.onSalePrice,originalPrice=detailInfo.originalPrice,address=detailInfo.address,traderName=detailInfo.traderName,expirationDate=detailInfo.expirationDate,quantity=detailInfo.quantity,img=detailInfo.img;var test;for(var x in img){test=img[x];}var imgarray=[];for(var c in test){imgarray.push(test[c]);}// const [quality, setQuality] = useState(0);\n// const [cart, setCart] = useState(0);\nvar theme=createMuiTheme({typography:{fontSize:5}});var productDiscountPrice=function productDiscountPrice(onsale,origin){return\"-\".concat(Math.round((origin-onsale)*100/origin),\"% off\");};// const addCart = () => {\n//     let number = quality;\n//     number = cart + number\n//     setCart(number);\n// }\nvar StyledBadge=withStyles(function(theme){return{badge:{right:-3,top:13,border:\"2px solid \".concat(theme.palette.background.paper),padding:'0 4px'}};})(Badge);var useStyle=makeStyles(function(thems){return{card:{width:300,height:400,marginTop:60,marginLeft:110},media:{width:'100%',height:'100%'},button:{border:'1px solid',padding:2,marginLeft:80,marginTop:40},button2:{border:'1px solid',padding:2,marginLeft:0,marginTop:40},buttonview:{border:'1px solid',padding:5,marginLeft:37,color:\"black\",backgroundColor:'#F5FFFA',width:175},box:{textAlign:'center',fontSize:18,width:'50%'},smallBox:{height:'100%',textAlign:'center',width:'50%'},grid:{backgroundColor:'#C4E1FF',padding:20},recommandButton:{width:'100%',fontSize:25,fontWeight:700,backgroundColor:'\t#5A5AAD','&:hover':{backgroundColor:'\t#BB3D00'},color:'white',height:'70px'}};});var classes=useStyle();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-card bg-white\",children:[/*#__PURE__*/_jsx(Grid,{container:true,direction:\"column\",children:/*#__PURE__*/_jsxs(Card,{className:classes.card,children:[/*#__PURE__*/_jsx(CardHeader,{className:classes.header,avatar:/*#__PURE__*/_jsx(Avatar,{src:imgarray[1]}),action:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"settings\"}),title:productName,subheader:traderName}),/*#__PURE__*/_jsx(CardMedia,{className:classes.media,image:imgarray[0]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-card-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"product-title-container\",children:/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsx(Typography,{variant:\"h1\",component:\"h2\",children:productName})})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-muted\",children:\"Sold By : \"}),/*#__PURE__*/_jsx(\"span\",{className:\"product-vendor\",children:traderName})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Ratings,{ratings:3.5,command:500,containerClassName:\"product-rating\",fullStarIcon:\"full-star-icon\",halfStarIcon:\"half-star-icon\",emptyStarIcon:\"empty-star-icon\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-price-container\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"product-price\",children:[\"NT $ \",onSalePrice]}),/*#__PURE__*/_jsxs(\"span\",{className:\"product-discount-price\",children:[\"$ \",originalPrice]}),/*#__PURE__*/_jsx(\"span\",{className:\"product-percentage-discount\",children:productDiscountPrice(onSalePrice,originalPrice)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-features-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-features\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"product-features-title text-muted\",children:\"Features:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"feature-fulfillmemt\",children:/*#__PURE__*/_jsx(Feature,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-features\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"product-features-title text-muted\",children:\"ExpirationDate:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"feature-text feature-color\",style:{textAlign:'center'},children:expirationDate})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-features\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"product-features-title text-muted\",children:\"quantity:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"product-features-title text-muted\",children:quantity})]})]})]})]}),/*#__PURE__*/_jsx(Button,{className:classes.recommandButton,onClick:function onClick(){fetchRecommandInfos(address,productName,traderName);},children:\"\\u9EDE\\u6211\\u770B\\u63A8\\u85A6\"}),/*#__PURE__*/_jsx(Grid,{container:true,direction:\"row\",justify:\"space-evenly\",className:classes.grid,children:recommand.map(function(item,index){return/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsx(Item,{props:item},index)});})})]});};export default Detail;","map":{"version":3,"sources":["/Users/laiyiying/Desktop/wp-final-project-deploy/src/containers/pages/product_details/ProductDetail.js"],"names":["React","useState","useEffect","Feature","Badge","withStyles","IconButton","Button","Typography","ThemeProvider","createMuiTheme","Grid","Card","CardHeader","makeStyles","Ratings","Avatar","CardMedia","Box","useParams","axios","Item","Detail","detailInfo","setDetailInfo","recommand","setRecommand","id","fetchDetailInfos","console","log","get","params","data","message","productInfo","productInfoObject","JSON","parse","Error","fetchRecommandInfos","address","productName","traderName","recommandItems","district","slice","productType","includes","re","traderAndBranch","split","trader","recommandType","searchTypeIndex","i","length","searchType","searchString","recommandItem","push","onSalePrice","originalPrice","expirationDate","quantity","img","test","x","imgarray","c","theme","typography","fontSize","productDiscountPrice","onsale","origin","Math","round","StyledBadge","badge","right","top","border","palette","background","paper","padding","useStyle","thems","card","width","height","marginTop","marginLeft","media","button","button2","buttonview","color","backgroundColor","box","textAlign","smallBox","grid","recommandButton","fontWeight","classes","header","map","item","index"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useState, useEffect } from \"react\";\nimport \"./detail.css\";\nimport Feature from './feature'\nimport Badge from '@material-ui/core/Badge';\nimport { withStyles } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport Button from '@material-ui/core/Button';\n\nimport Typography from '@material-ui/core/Typography';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport Grid from \"@material-ui/core/Grid\";\nimport Card from '@material-ui/core/Card';\nimport CardHeader from \"@material-ui/core/CardHeader\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Ratings from \"./rating\";\nimport { Avatar, CardMedia } from \"@material-ui/core\";\nimport Box from '@material-ui/core/Box';\n\nimport { useParams } from \"react-router\";\nimport axios from '../../../api';\nimport Item from '../../../components/Item';\n\n\nconst Detail = () => {\n\n\n    const [detailInfo, setDetailInfo] = useState({})\n    const [recommand, setRecommand] = useState([]);\n    let id = useParams();\n    useEffect(() => {\n        fetchDetailInfos();\n    }, []);\n\n\n    const fetchDetailInfos = async () => {\n        console.log(id);\n        try {\n            const { data: { message, productInfo } } = await axios.get('/api/get-product-info', { params: id });\n            const productInfoObject = JSON.parse(productInfo);\n            console.log(message);\n            setDetailInfo(productInfoObject);\n        } catch (error) {\n            throw Error(`When fetching detail information => Error: ${error}`);\n        }\n    }\n\n    const fetchRecommandInfos = async (address, productName, traderName) => {\n        let recommandItems = [];\n        console.log(address);\n        // XX區.....\n        const district = address.slice(0, 3);\n        // XX麵包 / XX蛋糕 / 兩個字的\n        const productType = productName.slice(-2);\n        // 店家名稱 連鎖店名--分店店名\n        // e.g. 全聯--大安店\n        let trader;\n        if (traderName.includes('--')) {\n            const re = /\\s*--\\s*/;\n            let traderAndBranch = traderName.split(re);\n            trader = traderAndBranch[0];\n        } else trader = traderName;\n        const recommandType = [productType, trader, district];\n        const searchTypeIndex = ['productName', 'traderName', 'address'];\n        for (let i=0;i<recommandType.length;i++){\n            let searchType = searchTypeIndex[i];\n            try {\n                const { data: { productInfo } } = await axios.get(\n                    '/api/get-product-info',\n                    { params: { searchString: recommandType[i], searchType: searchType } }\n                );\n                const recommandItem = JSON.parse(productInfo)\n                recommandItems.push(recommandItem[0]);\n            } catch (error) {\n                throw new Error('Error at get recommand items' + error);\n            }\n        }\n        setRecommand(recommandItems);\n    }\n\n\n    const { productName, onSalePrice, originalPrice, address, traderName, expirationDate, quantity,img } = detailInfo;\n    var test\n    for (var x in img){\n        test=img[x]\n    }\n    var imgarray=[]\n    for (var c in test){\n        imgarray.push(test[c])\n    }\n\n    \n\n    // const [quality, setQuality] = useState(0);\n    // const [cart, setCart] = useState(0);\n\n    const theme = createMuiTheme({\n        typography: {\n            fontSize: 5,\n        },\n    });\n    const productDiscountPrice = (onsale, origin) => {\n        return `-${Math.round(((origin - onsale) * 100) / origin)}% off`;\n\n    }\n    // const addCart = () => {\n    //     let number = quality;\n    //     number = cart + number\n    //     setCart(number);\n    // }\n\n    const StyledBadge = withStyles((theme) => ({\n        badge: {\n            right: -3,\n            top: 13,\n            border: `2px solid ${theme.palette.background.paper}`,\n            padding: '0 4px',\n        },\n    }))(Badge);\n    const useStyle = makeStyles((thems) => ({\n        card: {\n            width: 300,\n            height: 400,\n            marginTop: 60,\n            marginLeft: 110\n\n        },\n        media: {\n            width: '100%',\n            height: '100%',\n        },\n        button: {\n            border: '1px solid',\n            padding: 2,\n            marginLeft: 80,\n            marginTop: 40\n        },\n        button2: {\n            border: '1px solid',\n            padding: 2,\n            marginLeft: 0,\n            marginTop: 40\n        },\n        buttonview: {\n            border: '1px solid',\n            padding: 5,\n            marginLeft: 37,\n            color: \"black\",\n            backgroundColor: '#F5FFFA',\n            width: 175\n        },\n        box: {\n            textAlign: 'center',\n            fontSize: 18,\n            width: '50%',\n        },\n        smallBox: {\n            height: '100%',\n            textAlign: 'center',\n            width: '50%',\n        },\n        grid:{\n            backgroundColor:'#C4E1FF',\n            padding:20,\n\n        },\n        recommandButton:{\n            width:'100%',\n            fontSize:25,\n            fontWeight:700,\n            backgroundColor:'\t#5A5AAD',\n            '&:hover':{\n                backgroundColor: '\t#BB3D00'\n            },\n            color:'white',\n            height:'70px'\n        }\n    }))\n    const classes = useStyle();\n\n\n\n    return (\n        <>\n            <div className=\"product-card bg-white\">\n                <Grid container direction='column' >\n                    <Card className={classes.card}>\n                        <CardHeader\n                            className={classes.header}\n                            avatar={<Avatar src={imgarray[1]} />}\n                            action={\n                                <IconButton aria-label=\"settings\">\n                                </IconButton>\n                            }\n                            title={productName}\n                            subheader={traderName}\n                        />\n                        \n                        <CardMedia className={classes.media} image={imgarray[0]}  />\n                    </Card>\n                </Grid>\n                <div className=\"product-card-details\">\n                    <div className=\"product-title-container\" >\n                        <ThemeProvider theme={theme}>\n                            <Typography variant=\"h1\" component=\"h2\">\n                                {productName}\n                            </Typography>\n                        </ThemeProvider>\n\n                    </div>\n                    <div>\n\n                        <span>\n                            <span className=\"text-muted\">Sold By : </span>\n                            <span className=\"product-vendor\">\n                                {traderName}\n                            </span>\n                        </span>\n\n                    </div>\n                    <div>\n                        <span>\n                            <Ratings\n                                ratings={3.5}\n                                command={500}\n                                containerClassName={\"product-rating\"}\n                                fullStarIcon={\"full-star-icon\"}\n                                halfStarIcon={\"half-star-icon\"}\n                                emptyStarIcon={\"empty-star-icon\"}\n                            />\n                        </span>\n                    </div>\n                    <div className=\"product-price-container\">\n                        <span className=\"product-price\">\n                            {/* {this.currencyKeys.name}\n                                        {productPrice(\n                                            this.product.price,\n                                            this.currencyKeys.value\n                                        )} */}\n                            NT $ {onSalePrice}\n\n                        </span>\n\n                        <span className=\"product-discount-price\">\n                            {/* {this.currencyKeys.name}\n                                            {productPrice(\n                                                this.product.discount_price,\n                                                this.currencyKeys.value\n                                            )} */}\n                            $ {originalPrice}\n                        </span>\n\n\n                        <span className=\"product-percentage-discount\">\n                            {productDiscountPrice(\n                                onSalePrice,\n                                originalPrice\n                            )}\n                        </span>\n                    </div>\n\n                    <div className=\"product-features-container\">\n                        <div className=\"product-features\">\n                            <p className=\"product-features-title text-muted\">\n                                Features:\n                            </p>\n                            <div className=\"feature-fulfillmemt\">\n                                <Feature />\n                            </div>\n                        </div>\n\n                        <div className=\"product-features\">\n                            <p className=\"product-features-title text-muted\">\n                                ExpirationDate:\n                            </p>\n                            <p\n                                className=\"feature-text feature-color\" style={{textAlign:'center'}}\n                            >\n                                {expirationDate}\n                            </p>\n                            {/* <span\n                                className=\"feature-text feature-color\"\n                            >\n                                Amount : {quantity}\n                            </span> */}\n                        </div>\n\n                        <div className=\"product-features\">\n                            <p className=\"product-features-title text-muted\">\n                                quantity:\n                            </p><p className=\"product-features-title text-muted\">{quantity}</p>\n                            {/* <div className=\"product-quantity\">\n\n                                <Button\n                                    aria-label=\"reduce\"\n                                    onClick={() => { (quality > 0) ? (setQuality(quality - 1)) : (setQuality(quality)) }}\n                                >\n                                    <RemoveIcon fontSize=\"small\" />\n                                </Button>\n                                <input\n                                    name=\"quantity\"\n                                    type=\"text\"\n                                    className=\"form-control\"\n                                    placeholder={quality}\n                                ></input>\n                                <Button\n                                    aria-label=\"increase\"\n                                    onClick={() => { setQuality(quality + 1); }}\n                                >\n                                    <AddIcon fontSize=\"small\" />\n                                </Button>\n\n                            </div> */}\n                        </div>\n\n                    </div>\n                    {/*\n                    <Grid container direction='row'>\n                        <IconButton aria-label=\"cart\">\n                            <StyledBadge badgeContent={cart} color=\"secondary\">\n                                <ShoppingCartIcon />\n                            </StyledBadge>\n                        </IconButton>\n                    </Grid>\n                     <div className=\"mt-4\">\n                        <Button\n                            variant=\"contained\"\n                            color=\"default\"\n                            // onClick = {() => { displayStatus({ type: \"error\", msg: \"already add to cart\",}) }}\n                            // type=\"button\"\n                            className=\"btn btn-primary btn-block btn-lg\"\n                            onClick={() => { addCart() }}\n                        // disabled={this.disableAddToCartButton()}\n                        // onClick={this.handleAddToCart}\n                        >\n                            Add To Cart\n                        </Button>\n                    </div> */}\n                </div>\n            </div>\n            <Button className={classes.recommandButton} onClick={() =>{ fetchRecommandInfos(address, productName, traderName)}}>點我看推薦</Button>\n            <Grid container direction='row' justify='space-evenly' className={classes.grid}>\n                      \n                {recommand.map((item, index) => (\n                    <Box >\n                        <Item props={item} key={index} />\n                    </Box>\n                ))}\n            </Grid>\n        </>\n\n    )\n\n}\nexport default Detail;\n"]},"metadata":{},"sourceType":"module"}